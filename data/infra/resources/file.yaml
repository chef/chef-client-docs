---
resource_reference: true
properties_resources_common_windows_security: true
resources_common_atomic_update: true
resources_common_guards: true
resources_common_notification: true
resources_common_properties: true
resource: file
resource_description_list:
  - markdown: Use the **file** resource to manage files directly on a node.
  - note:
      markdown: >-
        Use the **cookbook_file** resource to copy a file from a cookbook's
        `/files` directory. Use the **template** resource to create a file based
        on a template in a cookbook's `/templates` directory. And use the
        **remote_file** resource to transfer a file to a node from a remote
        location.
syntax_description: |-
  A **file** resource block manages files that exist on nodes. For
  example, to write the home page for an Apache website:

  ```ruby
  file '/var/www/customers/public_html/index.php' do
    content '<html>This is a placeholder for the home page.</html>'
    mode '0755'
    owner 'web_admin'
    group 'web_admin'
  end
  ```
syntax_full_code_block: |-
  file 'name' do
    atomic_update              true, false
    backup                     Integer, false # default value: 5
    checksum                   String
    content                    String
    force_unlink               true, false # default value: false
    group                      Integer, String
    inherits                   true, false # default value: true
    manage_symlink_source      true, false
    mode                       Integer, String
    owner                      Integer, String
    path                       String # default value: 'name' unless specified
    rights                     Integer, String
    verify                     String, Block, Symbol
    action                     Symbol # defaults to :create if not specified
  end
syntax_properties_list:
  - >-
    `'/var/www/customers/public_html/index.php'` is path to the file and also
    the filename to be managed
  - '`content` defines the contents of the file'
syntax_full_properties_list:
- "`file` is the resource."
- "`name` is the name given to the resource block."
- "`action` identifies which steps Chef Infra Client will take to bring the node into
  the desired state."
- "`atomic_update`, `backup`, `checksum`, `content`, `force_unlink`, `group`, `manage_symlink_source`,
  `mode`, `owner`, and `path` are the properties available to this resource."
actions_list:
  ':create':
    markdown: >-
      (default) Create a file. If a file already exists (but does not match),
      update that file to match.
  ':create_if_missing':
    markdown: >-
      Create a file only if the file does not exist. When the file exists,
      nothing happens.
  ':delete':
    markdown: Delete a file.
  ':nothing':
    shortcode: resources_common_actions_nothing.md
  ':touch':
    markdown: >-
      Touch a file. This updates the access (atime) and file modification
      (mtime) times for a file.
properties_list:
- property: atomic_update
  ruby_type: true, false
  required: false
  default_value: False if modifying /etc/hosts, /etc/hostname, or /etc/resolv.conf
    within Docker containers. Otherwise default to the client.rb 'file_atomic_update'
    config value.
  description_list:
  - markdown: Perform atomic file updates on a per-resource basis. Set to true for
      atomic file updates. Set to false for non-atomic file updates. This setting
      overrides `file_atomic_update`, which is a global setting found in the `client.rb`
      file.
- property: backup
  ruby_type: Integer, false
  required: false
  default_value: '5'
  description_list:
  - markdown: The number of backups to be kept in `/var/chef/backup` (for UNIX- and
      Linux-based platforms) or `C:/chef/backup` (for the Microsoft Windows platform).
      Set to `false` to prevent backups from being kept.
- property: checksum
  ruby_type: String
  required: false
  description_list:
  - markdown: The SHA-256 checksum of the file. Use to ensure that a specific file
      is used. If the checksum does not match, the file is not used.
- property: content
  ruby_type: String
  required: false
  description_list:
  - markdown: A string that is written to the file. The contents of this property
      replace any previous content when this property has something other than the
      default value. The default behavior will not modify content.
- property: force_unlink
  ruby_type: true, false
  required: false
  default_value: 'false'
  description_list:
  - markdown: How Chef Infra Client handles certain situations when the target file
      turns out not to be a file. For example, when a target file is actually a symlink.
      Set to `true` for Chef Infra Client to delete the non-file target and replace
      it with the specified file. Set to `false` for Chef Infra Client to raise an
      error.
- property: group
  ruby_type: ''
  required: false
  description_list:
  - markdown:
- property: manage_symlink_source
  ruby_type: true, false
  required: false
  description_list:
  - markdown: Change the behavior of the file resource if it is pointed at a symlink.
      When this value is set to true, Chef Infra Client will manage the symlink's
      permissions or will replace the symlink with a normal file if the resource has
      content. When this value is set to false, Chef Infra Client will follow the
      symlink and will manage the permissions and content of symlink's target file.
      The default behavior is true but emits a warning that the default value will
      be changed to false in a future version; setting this explicitly to true or
      false suppresses this warning.
- property: mode
  ruby_type: ''
  required: false
  description_list:
  - markdown:
- property: owner
  ruby_type: ''
  required: false
  description_list:
  - markdown:
- property: path
  ruby_type: String
  required: false
  default_value: The resource block's name
  description_list:
  - markdown: 'The full path to the file, including the file name and its extension.
      For example: /files/file.txt. Default value: the name of the resource block.
      Microsoft Windows: A path that begins with a forward slash `/` will point to
      the root of the current working directory of the Chef Infra Client process.
      This path can vary from system to system. Therefore, using a path that begins
      with a forward slash `/` is not recommended.'
target_mode:
  support: full
properties_multiple_packages: false
resource_directory_recursive_directories: false
remote_file_prevent_re_downloads: false
remote_file_unc_path: false
ps_credential_helper: false
ruby_style_basics_chef_log: false
debug_recipes_chef_shell: false
examples: |2
   **Create a file**

    ```ruby
    file '/tmp/something' do
      owner 'root'
      group 'root'
      mode '0755'
      action :create
    end
    ```

    **Create a file in Microsoft Windows**

    To create a file in Microsoft Windows, be sure to add an escape
    character---`\`---before the backslashes in the paths:

    ```ruby
    file 'C:\\tmp\\something.txt' do
      rights :read, 'Everyone'
      rights :full_control, 'DOMAIN\\User'
      action :create
    end
    ```

    **Remove a file**

    ```ruby
    file '/tmp/something' do
      action :delete
    end
    ```

    **Set file modes**

    ```ruby
    file '/tmp/something' do
      mode '0755'
    end
    ```

    **Delete a repository using yum to scrub the cache**

    ```ruby
    # the following code sample thanks to gaffneyc @ https://gist.github.com/918711

    execute 'clean-yum-cache' do
      command 'yum clean all'
      action :nothing
    end

    file '/etc/yum.repos.d/bad.repo' do
      action :delete
      notifies :run, 'execute[clean-yum-cache]', :immediately
      notifies :create, 'ruby_block[reload-internal-yum-cache]', :immediately
    end
    ```

    **Add the value of a data bag item to a file**

    The following example shows how to get the contents of a data bag item
    named `impossible_things`, create a .pem file located at
    `some/directory/path/`, and then use the `content` attribute to update
    the contents of that file with the value of the `impossible_things` data
    bag item:

    ```ruby
    private_key = data_bag_item('impossible_things', private_key_name)['private_key']

    file "some/directory/path/#{private_key_name}.pem" do
      content private_key
      owner 'root'
      group 'group'
      mode '0755'
    end
    ```

    **Write a YAML file**

    The following example shows how to use the `content` property to write a
    YAML file:

    ```ruby
    file "#{app['deploy_to']}/shared/config/settings.yml" do
      owner "app['owner']"
      group "app['group']"
      mode '0755'
      content app.to_yaml
    end
    ```

    **Write a string to a file**

    The following example specifies a directory, and then uses the `content`
    property to add a string to the file created in that directory:

    ```ruby
    status_file = '/path/to/file/status_file'

    file status_file do
      owner 'root'
      group 'root'
      mode '0755'
      content 'My favourite foremost coastal Antarctic shelf, oh Larsen B!'
    end
    ```

    **Create a file from a copy**

    The following example shows how to copy a file from one directory to
    another, locally on a node:

    ```ruby
    file '/root/1.txt' do
      content IO.read('/tmp/1.txt')
      action :create
    end
    ```

    where the `content` attribute uses the Ruby `IO.read` method to get the
    contents of the `/tmp/1.txt` file.
